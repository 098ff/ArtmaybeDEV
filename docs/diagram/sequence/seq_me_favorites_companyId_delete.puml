@startuml
title Favorites Flow: DELETE /api/me/favorites/:companyId
actor Client
participant "«Node.js»\nserver" as Server
participant "«router»\nfavorites" as Router
participant "«middleware»\nauth" as AuthMW
participant "«controller»\nfavorites" as Ctrl
database "«MongoDB»\nDatabase" as DB

== Api/me/Favorites/:companyid ==
Client -> Server : DELETE /api/me/favorites/:companyId
activate Server
Server -> Router : router.delete('/me/favorites/:companyId', protect, deleteFavorite)
activate Router
Router -> AuthMW : protect(req, res, next)
activate AuthMW
AuthMW -> DB : verify JWT / load user
activate DB
DB --> AuthMW : user / ok
deactivate DB
AuthMW --> Router : next()
deactivate AuthMW
Router -> Ctrl : deleteFavorite(req, res)
activate Ctrl
Ctrl -> DB : Favorite.findOneAndDelete({ user, companyId })
activate DB
DB --> Ctrl : deleted?
deactivate DB
alt found
  Ctrl --> Client : 200 OK { success:true }
else not found
  Ctrl --> Client : 404 Not Found
end
deactivate Ctrl
deactivate Router
deactivate Server
== Api/me/Favorites/:companyid ==
@enduml